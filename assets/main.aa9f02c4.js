import{i as e,E as a,a as n,s as t,H as s,C as o,k as r,d as l,h as i,c,b as u,e as d,M as p,f,r as m,o as v,g as y,l as g,j as h,m as b,n as w,p as E,q as S,t as k,u as K,v as N,w as R,x as T,y as M,z as A,A as C,N as L,B as I,D as _,F as q,G as O,I as x,J as V,K as B,L as D,S as P,O as j,P as F,Q as Y}from"./vendor.22725f76.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)})).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?a.credentials="include":"anonymous"===e.crossorigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();const J=new((await e({locateFile:e=>`https://innei.github.io/vue-codemirror.next-sql-editor-demo/${e}`})).Database);J.run("\nCREATE TABLE \"users\" (\"id\" integer,\"name\" varchar,\"age\" int, PRIMARY KEY (id));\n\nINSERT INTO \"users\" (\"id\", \"name\", \"age\") VALUES\n('1', 'John', '12'),\n('2', 'Tom', '24'),\n('3', 'Adriana Barco', '24'),\n('4', 'John Richardson', '24'),\n('5', 'Martha Dawson', '24'),\n('6', 'Niels Wilmsen', '24'),\n('7', '杨红', '24'),\n('8', 'Mercedes Pereira Roselló', '24')\n\n\n;\n\n\nCREATE TABLE \"books\" (\"id\" integer,\"name\" varchar,\"price\" float, PRIMARY KEY (id));\n\nINSERT INTO \"books\" (\"id\", \"name\", \"price\") VALUES\n('1', '码农翻身', '12.00'),\n('2', '编码 - 隐匿于计算机背后的语言', '24.00');\n\n");const U=["users","books"],z={users:[{label:"id"},{label:"name"},{label:"age"}],books:[{label:"id"},{label:"name"},{label:"price"}]};class Q extends Error{[Symbol.toStringTag]="QueryError"}a.theme({"&":{height:"100%"},"&:focus":{outline:"none !important"}});const W=[{key:"Tab",run:e=>n(e)},{key:"Shift-Space",run:t}],$=s.define([]),G={defaultKeymap:new o,historyKeymap:new o,completionKeymap:new o,commentKeymap:new o,customKeyMap:new o,sql:new o,theme:new o},H=[G.defaultKeymap.of(r.of(l)),G.historyKeymap.of(r.of(i)),G.customKeyMap.of(r.of(W)),G.completionKeymap.of(r.of(c)),G.commentKeymap.of(r.of(u)),G.sql.of(d({dialect:p})),G.theme.of(f)];var X="_wrapper_1hkzt_1";const Z=N({props:{initialValue:{type:String,default:""},onChange:{type:Function},className:{type:String},editorRef:{type:Object}},setup(e){const[n,t]=(e=>{const n=m(),t=m(),{onChange:s}=e;return v((()=>{if(!n.value)return;const o=y.create({doc:e.initialDoc,extensions:[...H,g(),h(),b(),w(),E(),S(),k({activateOnTyping:!0,defaultKeymap:!0}),K({dialect:p}),$,a.lineWrapping,a.updateListener.of((e=>{e.changes&&s&&s(e.state)}))]}),r=new a({state:o,parent:n.value});t.value=r})),[n,t]})({initialDoc:e.initialValue,onChange:e.onChange});return R((()=>{e.editorRef&&t.value&&(e.editorRef.value=t.value)})),()=>T("div",{class:M(X,e.className),ref:n})}});var ee="_wrapper_p2748_1",ae="_top-grid_p2748_7";const ne=N({setup(){const e=m(),a=U.map((e=>({key:e,label:e}))),n=m(null),t=m(""),s=A();C((()=>n.value),(e=>{e&&(t.value=`SELECT * FROM ${e};`,u.value=[],c.value=[])})),C((()=>t.value),(a=>{if(e.value){e.value.state.doc.toString()!==a&&e.value.dispatch({changes:{from:0,to:e.value.state.doc.length,insert:a}})}}));const i=async()=>{s.success(t.value);const e=await async function(e){try{return J.exec(e)}catch(a){return console.log(a),new Q(a.message)}}(t.value);if(e instanceof Q)return u.value=[],c.value=[],void s.error(e.message);const{columns:a,values:n}=e[0],o=n.map((e=>{return n=e,a.reduce(((e,a,t)=>(e[a]=n[t],e)),{});var n}));u.value=o,c.value=a.map((e=>({rowName:e})))},c=m([]),u=m([]);{const a=R((()=>{if(e.value){const n=e.value,t=(new o).of(r.of([{key:"Mod-Enter",run:e=>(i(),!1)}]));n.dispatch({effects:P.appendConfig.of(t)}),n.dispatch({effects:G.defaultKeymap.reconfigure(r.of([...l.filter((e=>"Mod-Enter"!==e.key))]))}),n.dispatch({effects:G.sql.reconfigure(d({dialect:p,tables:U.map((e=>({label:e}))),schema:z}))}),a()}}))}return()=>T(D,{hasSider:!0},T(V,{bordered:!0,collapsed:!1,width:240},T(B,{value:n.value,onUpdateValue:e=>{n.value=e},options:a})),T(L,null,T("div",{class:ee},T(Z,{className:ae,editorRef:e,initialValue:"select * from `users` limit 1;",onChange:e=>{t.value=e.doc.toString()}}),T(L,null,T(I,{justify:"space-between",align:"center",class:"px-4"},T(_,null,"Mod+/ quick to run query."),T(q,null,T(O,{round:!0,type:"primary",onClick:i},"查询")))),T(L,{nativeScrollbar:!1,embedded:!0},T(x,{bordered:!1,class:"h-full overflow-auto",data:u.value,columns:c.value.map((e=>({title:e.rowName,key:e.rowName})))})))))}});j(N((()=>()=>T(Y,null,T(F,null,T(ne,null)))))).mount(document.getElementById("app"));
