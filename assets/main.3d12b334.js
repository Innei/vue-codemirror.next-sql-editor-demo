import{i as I,E as g,a as O,s as D,H as F,C as c,k as p,d as C,h as V,c as _,b as P,e as K,M as E,f as Q,r as m,o as j,g as H,l as J,j as Y,m as $,n as G,p as U,q as z,t as W,u as X,v as b,w as M,x as o,y as Z,z as ee,A,N as w,B as te,D as ae,F as oe,G as ne,I as se,J as re,K as ie,L as le,S as ue,O as ce,P as de,Q as pe}from"./vendor.dcbbe2ce.js";const me=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(a){if(a.ep)return;a.ep=!0;const n=r(a);fetch(a.href,n)}};me();const fe=`
CREATE TABLE "users" ("id" integer,"name" varchar,"age" int, PRIMARY KEY (id));

INSERT INTO "users" ("id", "name", "age") VALUES
('1', 'John', '12'),
('2', 'Tom', '24'),
('3', 'Adriana Barco', '24'),
('4', 'John Richardson', '24'),
('5', 'Martha Dawson', '24'),
('6', 'Niels Wilmsen', '24'),
('7', '\u6768\u7EA2', '24'),
('8', 'Mercedes Pereira Rosell\xF3', '24')


;


CREATE TABLE "books" ("id" integer,"name" varchar,"price" float, PRIMARY KEY (id));

INSERT INTO "books" ("id", "name", "price") VALUES
('1', '\u7801\u519C\u7FFB\u8EAB', '12.00'),
('2', '\u7F16\u7801 - \u9690\u533F\u4E8E\u8BA1\u7B97\u673A\u80CC\u540E\u7684\u8BED\u8A00', '24.00');

`,ye=await I({locateFile:e=>`https://innei.github.io/vue-codemirror.next-sql-editor-demo/${e}`}),L=new ye.Database;L.run(fe);const R=["users","books"],he={users:[{label:"id"},{label:"name"},{label:"age"}],books:[{label:"id"},{label:"name"},{label:"price"}]};class k extends Error{[Symbol.toStringTag]="QueryError"}async function ge(e){try{return L.exec(e)}catch(s){return console.log(s),new k(s.message)}}g.theme({"&":{height:"100%"},"&:focus":{outline:"none !important"}});const ve=[{key:"Tab",run(e){return O(e)}},{key:"Shift-Space",run:D}],Ee=F.define([]),u={defaultKeymap:new c,historyKeymap:new c,completionKeymap:new c,commentKeymap:new c,customKeyMap:new c,sql:new c,theme:new c},be=[u.defaultKeymap.of(p.of(C)),u.historyKeymap.of(p.of(V)),u.customKeyMap.of(p.of(ve)),u.completionKeymap.of(p.of(_)),u.commentKeymap.of(p.of(P)),u.sql.of(K({dialect:E})),u.theme.of(Q)],we=e=>{const s=m(),r=m(),{onChange:i}=e;return j(()=>{if(!s.value)return;const a=H.create({doc:e.initialDoc,extensions:[...be,J(),Y(),$(),G(),U(),z(),W({activateOnTyping:!0,defaultKeymap:!0}),X({dialect:E}),Ee,g.lineWrapping,g.updateListener.of(l=>{l.changes&&i&&i(l.state)})]}),n=new g({state:a,parent:s.value});r.value=n}),[s,r]},Se="_wrapper_1hkzt_1";var Ne={wrapper:Se};const Ce=b({props:{initialValue:{type:String,default:""},onChange:{type:Function},className:{type:String},editorRef:{type:Object}},setup(e){const[s,r]=we({initialDoc:e.initialValue,onChange:e.onChange});return M(()=>{e.editorRef&&r.value&&(e.editorRef.value=r.value)}),()=>o("div",{class:Z(Ne.wrapper,e.className),ref:s})}}),Ke="_wrapper_p2748_1";var q={wrapper:Ke,"top-grid":"_top-grid_p2748_7"};const Me=b({setup(){const e=m(),s=R.map(t=>({key:t,label:t})),r=m(null),i=m(""),a=ee();A(()=>r.value,t=>{t&&(i.value=`SELECT * FROM ${t};`,h.value=[],l.value=[])}),A(()=>i.value,t=>{e.value&&e.value.state.doc.toString()!==t&&e.value.dispatch({changes:{from:0,to:e.value.state.doc.length,insert:t}})});const n=async()=>{a.success(i.value);const t=await ge(i.value);if(t instanceof k){h.value=[],l.value=[],a.error(t.message);return}const{columns:d,values:S}=t[0],v=(y,x)=>y.reduce((N,T,B)=>(N[T]=x[B],N),{}),f=S.map(y=>v(d,y));h.value=f,l.value=d.map(y=>({rowName:y}))},l=m([]),h=m([]);{const t=M(()=>{if(e.value){const d=e.value,v=new c().of(p.of([{key:"Mod-Enter",run(f){return n(),!1}}]));d.dispatch({effects:ue.appendConfig.of(v)}),d.dispatch({effects:u.defaultKeymap.reconfigure(p.of([...C.filter(f=>f.key!=="Mod-Enter")]))}),d.dispatch({effects:u.sql.reconfigure(K({dialect:E,tables:R.map(f=>({label:f})),schema:he}))}),t()}})}return()=>o(le,{hasSider:!0},o(re,{bordered:!0,collapsed:!1,width:240},o(ie,{value:r.value,onUpdateValue:t=>{r.value=t},options:s})),o(w,null,o("div",{class:q.wrapper},o(Ce,{className:q["top-grid"],editorRef:e,initialValue:"select * from `users` limit 1;",onChange:t=>{i.value=t.doc.toString()}}),o(w,null,o(te,{justify:"space-between",align:"center",class:"px-4"},o(ae,null,"Mod+/ quick to run query."),o(oe,null,o(ne,{round:!0,type:"primary",onClick:n},"\u67E5\u8BE2")))),o(w,{nativeScrollbar:!1,embedded:!0},o(se,{bordered:!1,class:"h-full overflow-auto",data:h.value,columns:l.value.map(t=>({title:t.rowName,key:t.rowName}))})))))}});const Ae=b(()=>()=>o(pe,null,o(de,null,o(Me,null)))),Le=ce(Ae);Le.mount(document.getElementById("app"));
